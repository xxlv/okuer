---
author: admin
comments: true
date: 2015-08-31 10:59:32+00:00
layout: post
slug: '%e5%a5%87%e6%80%aa%e7%9a%84bug'
title: 2015-8-31:从奇怪的Bug开始
wordpress_id: 302
categories:
- Daily
---

这是令人沮丧的一天，整个上午都表现的精神不集中，早上偶然翻微信看了一篇关于如果发现自己生活目的的科学实验，大概是讲:

**找个安静的房间，关掉一切通讯，给自己人生重要的一小时，找一张白纸，在上面写上你想要的生活.....**

我很怀疑人生仅仅在一小时能够有多大的改变，但我仍旧想找个机会尝试一下，真的，生活的转折点在看似不起眼的几分钟。

好了，先说说今天的dev遇到了什么问题吧，说实话我是比较羞愧的，我居然将一个上传头像的功能用了好几周都没搞定。我知道责任不在我，有很多因素，譬如中途别的项目的介入导致我没有时间完成，但这仍旧是令人不爽的。我不该寻找只能内网开发，测试在外网，无法debug而且碰巧外网的某个文件夹不确定有没有w权限的借口，问题出在我的身上。

我正在使用Zend Framework2 做开发，这是一个设计非常棒的PHP MVC 框架，（吐槽下，它太臃肿了，学习路线也比较陡峭），我尝试使用Zend\File\Transfer\Adapter\Http 来接受一个来自form的file，但总是得到莫名奇怪的错误。（我一直相信这些错误在外网很快就能找到的）。下面是其中一个错误：

SecurityError: Blocked a frame with origin "http://xxx.com" from accessing a cross-origin frame.TypeError: Cannot read property 'indexOf' of undefined



这错误分析应是frame的安全性问题，毕竟ajax无法提交文件的([http://stackoverflow.com/questions/19773445/how-to-upload-file-via-an-ajax-form-in-zend-framework-2](http://stackoverflow.com/questions/19773445/how-to-upload-file-via-an-ajax-form-in-zend-framework-2))。

这里有部分解释[http://stackoverflow.com/questions/25098021/securityerror-blocked-a-frame-with-origin-from-accessing-a-cross-origin-frame](http://stackoverflow.com/questions/25098021/securityerror-blocked-a-frame-with-origin-from-accessing-a-cross-origin-frame)

等等，写js的家伙用ajaxFileUpload.js这个jq插件来异步提交文件，而这个js的内部是使用隐藏iframe来实现ajax提交的。

抱着怀疑的态度查看了ajaxFileUpload.js的源（https://github.com/jfeldstein/jQuery.AjaxFileUpload.js），大概在134行发现了

    
     var wrapElement = function(element) {
                // Create an iframe to submit through, using a semi-unique ID
                var frame_id = 'ajaxUploader-iframe-' + Math.round(new Date().getTime() / 1000)
                $('body').after('<iframe width="0" height="0" style="display:none;" name="'+frame_id+'" id="'+frame_id+'"/>');
                $('#'+frame_id).get(0).onload = function() {
                  handleResponse(this, element);
                };


原来，人家已经用了隐藏的iframe实现了，那我这错误从何报起啊？

我先暂时把这个错误记做#1508311(//TODO)。

这确实使人沮丧，更沮丧的是，到现在为止我都没有找到这个Bug出现的原因。

哦， 对了，今天群里面还有人遇到这样一个问题，$a&$b的问题。

    
    $a='a';
    $b='b';
    echo $a&b;


忽然发现居然没用过php的ord方法，该方法是获得参数的ASCII码。注意输入字符串abc,则返回a的ASCII。同样它的姐妹方法是chr，通过ASCII获得字符。














